<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Teachers Â· Asia & Julio Primary School LMS</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = "https://flwjrnzczjkiamcgvzev.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZsd2pybnpjempraWFtY2d2emV2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3MDczMTcsImV4cCI6MjA4MTI4MzMxN30.6QWeaOS1o0dkp0RirjW_x_P-hjs6BeM4ytgCYiTCOiQ";
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    async function postTeacherAnnouncement() {
      const message = document.getElementById("teacherMessage").value.trim();
      if (!message) return alert("Please enter a message.");
      await supabase.from("announcements").insert([
        { role: "teacher", message, time: new Date().toLocaleString() }
      ]);
      document.getElementById("teacherMessage").value = "";
      alert("Announcement sent to Students & Parents.");
    }

    async function loadAdminAnnouncements() {
      const { data } = await supabase.from("announcements")
        .select("*").eq("role", "admin").order("time", { ascending: false });
      const list = document.getElementById("adminAnnouncements");
      list.innerHTML = "";
      data.forEach(a => {
        list.innerHTML += `<div><strong>Admin:</strong> ${a.message} <em>${a.time}</em></div>`;
      });
    }

    document.addEventListener("DOMContentLoaded", loadAdminAnnouncements);
  </script>
</head>
<body>
  <header class="site-header">
    <h1>Teachers</h1>
    <a href="index.html">â† Back to Home</a>
  </header>
  <main>
    <h2>ğŸ“¢ Announcements from Admin</h2>
    <div id="adminAnnouncements"></div>

    <h2>ğŸ“¢ Send Announcement to Students & Parents</h2>
    <textarea id="teacherMessage" rows="3" style="width:100%;"></textarea><br>
    <button onclick="postTeacherAnnouncement()">Send</button>
  </main>
</body>
</html>
